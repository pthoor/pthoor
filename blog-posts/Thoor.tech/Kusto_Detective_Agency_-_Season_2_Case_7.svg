<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 610 110" width="600" height="100" xmlns:xlink="http://www.w3.org/1999/xlink">
  <defs>
    <style>
      .title {
        font-size: 1.5em;
        text-overflow: ellipsis;
        overflow: hidden;
        white-space: nowrap;
      }
      .description {
        font-size: 0.75em;
        text-overflow: ellipsis;
        overflow: hidden;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
      }
      .text {
        text-align: start;
        padding: 10px;
        height: calc(100% - 20px);
        margin-left: 0;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
        color: black;
      }
           .date {
        font-size: 0.5em;
        opacity: 0.5;
        text-align: end;
        position: absolute;
        bottom: 0;
        right: 10px;
        color: black;
      }
      
      .main {
        fill: white;
      }
      .data {
        opacity: 0.75;
        text-align: start;
        position: absolute;
        bottom: 0;
        padding-bottom: 5px;
        left: 10px;
        color: black;
        max-width: 400px;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
      }
      .author {
        opacity: 0.75;
        font-size: 0.5em;
      }
      .category {
        background-color: rgba(0, 0, 0, 0.25);
        border-radius: 0.25em;
        padding: 0.125em 0.25em;
        font-size: 0.75em;
        color: rgba(0, 0, 0, 0.8);
      }
    </style>
  </defs>
  <g class="main">
    <rect class="content" width="600" height="100" stroke="rgba(0, 0, 0, 0.5)" x="5" y="5" rx="10" />
    <foreignObject width="600" height="100" x="5" y="5">
      <div xmlns="http://www.w3.org/1999/xhtml" style="border-radius: 5px; overflow: hidden; height: 100%;">
        <div class="text">
          <div class="title">Kusto&#0032;Detective&#0032;Agency&#0032;&#0045;&#0032;Season&#0032;2&#0032;Case&#0032;7</div>
          <div class="description">Mission&#0032;Connect&#0010;&#0010;Riddle&#0010;Hi&#0032;Detective&#0044;&#0010;It’s&#0032;been&#0032;awesome&#0032;witnessing&#0032;your&#0032;progress&#0046;&#0032;Seriously&#0044;&#0032;you’ve&#0032;climbed&#0032;to&#0032;new&#0032;heights&#0032;in&#0032;uncovering&#0032;the&#0032;misdeeds&#0032;of&#0032;sly&#0032;cyber&#0045;criminal&#0044;&#0032;Krypto&#0046;&#0032;We&#0044;&#0032;the&#0032;National&#0032;Security&#0032;Office&#0032;&#0040;NSO&#0041;&#0044;&#0032;had&#0032;our&#0032;eyes&#0032;on&#0032;him&#0032;for&#0032;ages&#0044;&#0032;and&#0032;thanks&#0032;to&#0032;your&#0032;information&#0044;&#0032;we&#0032;finally&#0032;managed&#0032;to&#0032;track&#0032;him&#0032;down&#0046;&#0032;I’ll&#0032;spare&#0032;you&#0032;the&#0032;thrilling&#0032;details&#0044;&#0032;but&#0032;guess&#0032;what&#0063;&#0032;Turns&#0032;out&#0032;our&#0032;guy&#0032;held&#0032;a&#0032;high&#0045;ranking&#0032;position&#0032;as&#0032;City&#0032;Manager&#0032;in&#0032;the&#0032;Mayor’s&#0032;office&#0044;&#0032;and&#0032;he&#0032;was&#0032;tight&#0032;with&#0032;Ms&#0046;&#0032;Gaia&#0032;Budskott&#0044;&#0032;the&#0032;Mayor&#0032;of&#0032;Digitown&#0046;&#0032;And&#0032;yes&#0044;&#0032;he’s&#0032;also&#0032;the&#0032;mastermind&#0032;behind&#0032;the&#0032;infamous&#0032;KUsto&#0032;ANti&#0045;Detective&#0032;Agency&#0032;&#0040;Kuanda&#0046;org&#0041;&#0032;that&#0032;you&#0032;brilliantly&#0032;exposed&#0046;&#0032;However&#0044;&#0032;here’s&#0032;the&#0032;unfortunate&#0032;part&#0058;&#0032;he&#0032;slipped&#0032;through&#0032;the&#0032;fingers&#0032;of&#0032;Digitown’s&#0032;law&#0032;enforcement&#0046;&#0032;Given&#0032;the&#0032;new&#0032;international&#0032;nature&#0032;of&#0032;the&#0032;case&#0044;&#0032;we&#0032;&#0040;the&#0032;NSO&#0041;&#0032;are&#0032;taking&#0032;over&#0046;&#0010;So&#0044;&#0032;let’s&#0032;cut&#0032;to&#0032;the&#0032;chase&#0046;&#0032;Time&#0032;is&#0032;of&#0032;the&#0032;essence&#0044;&#0032;and&#0032;we&#0032;need&#0032;your&#0032;expertise&#0032;and&#0032;experience&#0032;to&#0032;help&#0032;us&#0032;find&#0032;the&#0032;final&#0032;destination&#0032;of&#0032;Krypto&#0046;&#0010;While&#0032;we&#0032;have&#0032;gathered&#0032;significant&#0032;information&#0032;about&#0032;him&#0044;&#0032;it&#0032;is&#0032;not&#0032;enough&#0032;to&#0032;capture&#0032;him&#0046;&#0032;Our&#0032;sources&#0032;indicate&#0032;that&#0032;he&#0032;was&#0032;spotted&#0032;at&#0032;the&#0032;Doha&#0032;airport&#0032;on&#0032;August&#0032;11&#0044;&#0032;2023&#0044;&#0032;between&#0032;03&#0058;30&#0032;AM&#0032;and&#0032;05&#0058;30&#0032;AM&#0032;&#0040;UTC&#0041;&#0046;&#0032;However&#0044;&#0032;by&#0032;the&#0032;time&#0032;our&#0032;agents&#0032;arrived&#0044;&#0032;he&#0032;had&#0032;already&#0032;made&#0032;his&#0032;escape&#0044;&#0032;presumably&#0032;utilizing&#0032;a&#0032;private&#0032;jet&#0046;&#0032;We&#0032;have&#0032;deployed&#0032;dozens&#0032;of&#0032;officers&#0032;to&#0032;all&#0032;potential&#0032;landing&#0032;destinations&#0044;&#0032;but&#0032;he&#0032;has&#0032;evaded&#0032;us&#0032;so&#0032;far&#0046;&#0032;We&#0032;have&#0032;a&#0032;single&#0032;lead&#0032;that&#0032;suggests&#0032;Krypto&#0032;may&#0032;have&#0032;attempted&#0032;a&#0032;plane&#0045;to&#0045;plane&#0032;jump&#0044;&#0032;given&#0032;his&#0032;skills&#0032;as&#0032;a&#0032;wingsuit&#0032;expert&#0046;&#0032;Here&#0032;is&#0032;where&#0032;we&#0032;got&#0032;stuck&#0046;&#0010;Fortunately&#0044;&#0032;we&#0032;have&#0032;you&#0032;&#0040;and&#0032;full&#0032;access&#0032;to&#0032;the&#0032;public&#0032;and&#0032;private&#0032;jet&#0032;plane&#0032;schedules&#0032;on&#0032;this&#0032;day&#0041;&#0046;&#0032;Your&#0032;mission&#0044;&#0032;should&#0032;you&#0032;choose&#0032;to&#0032;accept&#0032;it&#0044;&#0032;is&#0032;to&#0032;determine&#0032;the&#0032;destination&#0032;to&#0032;which&#0032;Krypto&#0032;has&#0032;fled&#0046;&#0010;Hoping&#0032;to&#0032;hear&#0032;back&#0032;from&#0032;you&#0032;soon&#0044;&#0010;NSO&#0032;Agent&#0032;Stas&#0032;Fistuko&#0010;Data&#0032;import&#0010;Man…&#0032;I&#0032;really&#0032;don’t&#0032;like&#0032;GeoLocation&#0032;cases&#0044;&#0032;but&#0032;I&#0032;guess&#0032;I&#0032;have&#0032;to&#0032;do&#0032;it&#0046;&#0032;Let’s&#0032;start&#0032;by&#0032;ingesting&#0032;the&#0032;data&#0058;&#0010;&#0010;&#0046;execute&#0032;database&#0032;script&#0032;&#0060;&#0124;&#0010;&#0046;create&#0045;merge&#0032;table&#0032;Flights&#0040;Timestamp&#0058;datetime&#0044;&#0032;callsign&#0058;string&#0044;&#0032;lat&#0058;real&#0044;&#0032;lon&#0058;real&#0044;&#0032;velocity&#0058;real&#0044;&#0032;heading&#0058;real&#0044;&#0032;vertrate&#0058;real&#0044;&#0032;onground&#0058;bool&#0044;&#0032;geoaltitude&#0058;real&#0041;&#0032;&#0010;&#0046;create&#0045;merge&#0032;table&#0032;Airports&#0032;&#0040;Id&#0058;string&#0044;&#0032;Ident&#0058;string&#0044;&#0032;Type&#0058;string&#0044;&#0032;Name&#0058;string&#0044;&#0032;lat&#0058;real&#0044;&#0032;lon&#0058;real&#0044;&#0032;elevation&#0095;ft&#0058;long&#0044;&#0032;iso&#0095;country&#0058;string&#0044;&#0032;iso&#0095;region&#0058;string&#0044;&#0032;municipality&#0058;string&#0044;&#0032;gps&#0095;code&#0058;string&#0044;&#0032;local&#0095;code&#0058;string&#0041;&#0032;&#0032;&#0010;&#0046;ingest&#0032;into&#0032;table&#0032;Airports&#0032;&#0040;&#0064;&#0039;https&#0058;&#0047;&#0047;kustodetectiveagency&#0046;blob&#0046;core&#0046;windows&#0046;net&#0047;kda2c7flights&#0047;airports&#0046;csv&#0046;gz&#0039;&#0041;&#0010;&#0046;ingest&#0032;async&#0032;into&#0032;table&#0032;Flights&#0032;&#0040;&#0064;&#0039;https&#0058;&#0047;&#0047;kustodetectiveagency&#0046;blob&#0046;core&#0046;windows&#0046;net&#0047;kda2c7flights&#0047;flights&#0095;1&#0046;csv&#0046;gz&#0039;&#0041;&#0010;&#0046;ingest&#0032;async&#0032;into&#0032;table&#0032;Flights&#0032;&#0040;&#0064;&#0039;https&#0058;&#0047;&#0047;kustodetectiveagency&#0046;blob&#0046;core&#0046;windows&#0046;net&#0047;kda2c7flights&#0047;flights&#0095;2&#0046;csv&#0046;gz&#0039;&#0041;&#0010;&#0046;ingest&#0032;into&#0032;table&#0032;Flights&#0032;&#0040;&#0064;&#0039;https&#0058;&#0047;&#0047;kustodetectiveagency&#0046;blob&#0046;core&#0046;windows&#0046;net&#0047;kda2c7flights&#0047;flights&#0095;3&#0046;csv&#0046;gz&#0039;&#0041;&#0010;&#0010;&#0010;Hints&#0032;and&#0032;clues&#0010;So&#0032;we&#0032;need&#0032;to&#0058;&#0010;Find&#0032;Doha&#0032;airport&#0010;Find&#0032;the&#0032;flight&#0032;that&#0032;was&#0032;in&#0032;Doha&#0032;airport&#0032;between&#0032;03&#0058;30&#0032;AM&#0032;and&#0032;05&#0058;30&#0032;AM&#0032;&#0040;UTC&#0041;&#0010;Assume&#0032;that&#0032;Krypto&#0032;jumped&#0032;from&#0032;that&#0032;flight&#0032;to&#0032;another&#0032;flight&#0010;Find&#0032;the&#0032;destination&#0032;of&#0032;the&#0032;second&#0032;flight&#0010;&#0010;Looking&#0032;at&#0032;the&#0032;data&#0032;and&#0032;start&#0032;the&#0032;hunt&#0010;Okey&#0044;&#0032;we&#0032;now&#0032;have&#0032;two&#0032;tables&#0058;&#0032;Flights&#0032;and&#0032;Airports&#0046;&#0010;&#0010;Flights&#0010;&#0124;&#0032;take&#0032;10&#0010;&#0010;&#0010;&#0010;Airports&#0010;&#0124;&#0032;take&#0032;10&#0010;&#0010;&#0010;Think&#0032;you&#0032;know&#0032;the&#0032;drill&#0032;by&#0032;now&#0046;&#0032;Always&#0032;good&#0032;to&#0032;look&#0032;into&#0032;the&#0032;tables&#0032;to&#0032;see&#0032;what&#0032;we’re&#0032;dealing&#0032;with&#0046;&#0010;Let’s&#0032;start&#0032;by&#0032;finding&#0032;the&#0032;Doha&#0032;airport&#0044;&#0032;I&#0032;have&#0032;no&#0032;clue&#0032;if&#0032;the&#0032;name&#0032;“Doha”&#0032;is&#0032;the&#0032;name&#0032;of&#0032;the&#0032;airport&#0032;or&#0032;the&#0032;city&#0044;&#0032;so&#0032;let’s&#0032;search&#0032;for&#0032;it&#0058;&#0010;&#0010;Airports&#0010;&#0124;&#0032;search&#0032;&#0034;Doha&#0034;&#0010;&#0010;&#0010;&#0010;Gotya&#0033;&#0032;It&#0032;was&#0032;the&#0032;municipality&#0046;&#0032;Now&#0032;let’s&#0032;find&#0032;the&#0032;flight&#0032;that&#0032;was&#0032;in&#0032;Hamad&#0032;International&#0032;Airport&#0032;between&#0032;03&#0058;30&#0032;AM&#0032;and&#0032;05&#0058;30&#0032;AM&#0032;&#0040;UTC&#0041;&#0058;&#0010;We&#0032;will&#0032;use&#0032;the&#0032;Timestamp&#0032;column&#0032;and&#0032;the&#0032;between&#0040;&#0041;&#0032;function&#0032;to&#0032;find&#0032;the&#0032;flights&#0032;that&#0032;were&#0032;in&#0032;the&#0032;airport&#0032;between&#0032;the&#0032;times&#0032;we&#0032;want&#0046;&#0010;&#0010;Flights&#0010;&#0124;&#0032;where&#0032;Timestamp&#0032;between&#0032;&#0040;datetime&#0040;2023&#0045;08&#0045;11&#0032;03&#0058;30&#0041;&#0032;&#0046;&#0046;&#0032;datetime&#0040;2023&#0045;08&#0045;11&#0032;05&#0058;30&#0041;&#0041;&#0010;&#0010;&#0010;We&#0032;could&#0032;also&#0032;specify&#0032;direct&#0032;times&#0032;into&#0032;the&#0032;between&#0040;&#0041;&#0032;function&#0044;&#0032;such&#0032;as&#0032;2h&#0032;instead&#0032;of&#0032;writing&#0032;the&#0032;datetime&#0040;&#0041;&#0032;function&#0032;again&#0044;&#0032;but&#0032;I&#0032;prefer&#0032;to&#0032;be&#0032;more&#0032;specific&#0046;&#0010;&#0010;Flights&#0010;&#0124;&#0032;where&#0032;Timestamp&#0032;between&#0032;&#0040;datetime&#0040;2023&#0045;08&#0045;11&#0032;03&#0058;30&#0041;&#0032;&#0046;&#0046;&#0032;2h&#0041;&#0010;&#0010;&#0010;Same&#0044;&#0032;same&#0046;&#0010;Because&#0032;we&#0032;are&#0032;looking&#0032;between&#0032;tables&#0032;we&#0032;must&#0032;use&#0032;the&#0032;join&#0032;operator&#0046;&#0032;Now&#0032;we&#0032;will&#0032;introduce&#0032;the&#0032;geo&#0095;point&#0095;to&#0095;s2cell&#0040;&#0041;&#0032;function&#0046;&#0032;I&#0032;know&#0044;&#0032;geo&#0032;stuff&#0044;&#0032;I&#0032;cannot&#0032;even&#0032;find&#0032;in&#0032;my&#0032;own&#0032;city&#0032;without&#0032;an&#0032;GPS&#0032;telling&#0032;me&#0032;where&#0032;to&#0032;go&#0046;&#0032;But&#0032;this&#0032;function&#0032;is&#0032;pretty&#0032;cool&#0044;&#0032;it&#0032;takes&#0032;a&#0032;longitude&#0032;and&#0032;latitude&#0032;and&#0032;converts&#0032;it&#0032;to&#0032;a&#0032;S2&#0032;cell&#0046;&#0032;S2&#0032;cells&#0032;are&#0032;a&#0032;way&#0032;to&#0032;divide&#0032;the&#0032;world&#0032;into&#0032;smaller&#0032;pieces&#0046;&#0010;In&#0032;the&#0032;join&#0032;operator&#0032;we&#0032;want&#0032;to&#0032;have&#0032;a&#0032;key&#0032;that&#0032;we&#0032;can&#0032;join&#0032;on&#0044;&#0032;so&#0032;we&#0032;will&#0032;use&#0032;the&#0032;geo&#0095;point&#0095;to&#0095;s2cell&#0040;&#0041;&#0032;function&#0032;to&#0032;create&#0032;a&#0032;key&#0032;for&#0032;each&#0032;row&#0032;in&#0032;the&#0032;table&#0046;&#0032;We&#0032;will&#0032;use&#0032;the&#0032;default&#0032;level&#0032;of&#0032;11&#0044;&#0032;but&#0032;you&#0032;can&#0032;specify&#0032;a&#0032;level&#0032;if&#0032;you&#0032;want&#0032;to&#0046;&#0032;We&#0032;also&#0032;want&#0032;to&#0032;add&#0032;that&#0032;the&#0032;planes&#0032;are&#0032;onground&#0044;&#0032;because&#0032;we&#0032;don’t&#0032;want&#0032;to&#0032;find&#0032;the&#0032;planes&#0032;that&#0032;are&#0032;in&#0032;the&#0032;air&#0046;&#0010;&#0010;let&#0032;s2&#0095;level&#0032;&#0061;&#0032;11&#0059;&#0032;&#0047;&#0047;&#0032;11&#0032;is&#0032;also&#0032;the&#0032;default&#0032;value&#0032;if&#0032;you&#0032;don&#0039;t&#0032;specify&#0032;it&#0010;Airports&#0010;&#0124;&#0032;where&#0032;municipality&#0032;has&#0032;&#0034;Doha&#0034;&#0010;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0124;&#0032;join&#0032;kind&#0061;inner&#0032;&#0040;&#0010;&#0032;&#0032;&#0032;&#0032;Flights&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;where&#0032;Timestamp&#0032;between&#0032;&#0040;datetime&#0040;2023&#0045;08&#0045;11&#0032;03&#0058;30&#0041;&#0032;&#0046;&#0046;&#0032;datetime&#0040;2023&#0045;08&#0045;11&#0032;05&#0058;30&#0041;&#0041;&#0032;and&#0032;onground&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0032;&#0032;&#0032;&#0032;&#0041;&#0032;on&#0032;key&#0010;&#0010;&#0010;Almost&#0032;700&#0032;records&#0046;&#0032;Let’s&#0032;add&#0032;distinct&#0032;callsign&#0032;to&#0032;the&#0032;query&#0032;to&#0032;only&#0032;see&#0032;the&#0032;unique&#0032;airplanes&#0046;&#0010;&#0010;let&#0032;s2&#0095;level&#0032;&#0061;&#0032;11&#0059;&#0032;&#0047;&#0047;&#0032;11&#0032;is&#0032;also&#0032;the&#0032;default&#0032;value&#0032;if&#0032;you&#0032;don&#0039;t&#0032;specify&#0032;it&#0010;Airports&#0010;&#0124;&#0032;where&#0032;municipality&#0032;has&#0032;&#0034;Doha&#0034;&#0010;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0124;&#0032;join&#0032;kind&#0061;inner&#0032;&#0040;&#0010;&#0032;&#0032;&#0032;&#0032;Flights&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;where&#0032;Timestamp&#0032;between&#0032;&#0040;datetime&#0040;2023&#0045;08&#0045;11&#0032;03&#0058;30&#0041;&#0032;&#0046;&#0046;&#0032;datetime&#0040;2023&#0045;08&#0045;11&#0032;05&#0058;30&#0041;&#0041;&#0032;and&#0032;onground&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0032;&#0032;&#0032;&#0032;&#0041;&#0032;on&#0032;key&#0010;&#0124;&#0032;distinct&#0032;callsign&#0010;&#0010;&#0010;19&#0032;airplanes&#0046;&#0032;Getting&#0032;closer&#0032;Krypto&#0033;&#0010;Let’s&#0032;add&#0032;the&#0032;result&#0032;to&#0032;its&#0032;own&#0032;variable&#0032;so&#0032;we&#0032;can&#0032;use&#0032;it&#0032;later&#0046;&#0010;&#0010;let&#0032;s2&#0095;level&#0032;&#0061;&#0032;11&#0059;&#0032;&#0047;&#0047;&#0032;11&#0032;is&#0032;also&#0032;the&#0032;default&#0032;value&#0032;if&#0032;you&#0032;don&#0039;t&#0032;specify&#0032;it&#0010;let&#0032;SuspiciousFlights&#0032;&#0061;&#0010;Airports&#0010;&#0124;&#0032;where&#0032;municipality&#0032;has&#0032;&#0034;Doha&#0034;&#0010;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0124;&#0032;join&#0032;kind&#0061;inner&#0032;&#0040;&#0010;&#0032;&#0032;&#0032;&#0032;Flights&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;where&#0032;Timestamp&#0032;between&#0032;&#0040;datetime&#0040;2023&#0045;08&#0045;11&#0032;03&#0058;30&#0041;&#0032;&#0046;&#0046;&#0032;datetime&#0040;2023&#0045;08&#0045;11&#0032;05&#0058;30&#0041;&#0041;&#0032;and&#0032;onground&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0032;&#0032;&#0032;&#0032;&#0041;&#0032;on&#0032;key&#0010;&#0124;&#0032;distinct&#0032;callsign&#0059;&#0010;&#0010;&#0010;Now&#0032;we&#0032;need&#0032;to&#0032;find&#0032;the&#0032;flight&#0032;that&#0032;Krypto&#0032;jumped&#0032;to&#0046;&#0032;We&#0032;will&#0032;use&#0032;the&#0032;same&#0032;method&#0032;as&#0032;before&#0044;&#0032;but&#0032;we&#0032;will&#0032;use&#0032;the&#0032;SuspiciousFlights&#0032;variable&#0032;in&#0032;a&#0032;where&#0032;clause&#0032;together&#0032;with&#0032;flights&#0032;that&#0032;was&#0032;not&#0032;on&#0032;the&#0032;ground&#0046;&#0010;&#0010;let&#0032;s2&#0095;level&#0032;&#0061;&#0032;11&#0059;&#0032;&#0047;&#0047;&#0032;11&#0032;is&#0032;also&#0032;the&#0032;default&#0032;value&#0032;if&#0032;you&#0032;don&#0039;t&#0032;specify&#0032;it&#0010;let&#0032;SuspiciousFlights&#0032;&#0061;&#0010;Airports&#0010;&#0124;&#0032;where&#0032;municipality&#0032;has&#0032;&#0034;Doha&#0034;&#0010;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0124;&#0032;join&#0032;kind&#0061;inner&#0032;&#0040;&#0010;&#0032;&#0032;&#0032;&#0032;Flights&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;where&#0032;Timestamp&#0032;between&#0032;&#0040;datetime&#0040;2023&#0045;08&#0045;11&#0032;03&#0058;30&#0041;&#0032;&#0046;&#0046;&#0032;datetime&#0040;2023&#0045;08&#0045;11&#0032;05&#0058;30&#0041;&#0041;&#0032;and&#0032;onground&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0032;&#0032;&#0032;&#0032;&#0041;&#0032;on&#0032;key&#0010;&#0124;&#0032;distinct&#0032;callsign&#0059;&#0010;Flights&#0010;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0124;&#0032;where&#0032;callsign&#0032;in&#0032;&#0040;SuspiciousFlights&#0041;&#0032;and&#0032;onground&#0032;&#0061;&#0061;&#0032;false&#0032;and&#0032;Timestamp&#0032;&#0062;&#0032;datetime&#0040;2023&#0045;08&#0045;11&#0032;05&#0058;30&#0041;&#0010;&#0010;&#0010;Too&#0032;many&#0032;results…&#0032;8415&#0032;records&#0046;&#0010;We&#0032;need&#0032;to&#0032;join&#0032;once&#0032;more&#0032;with&#0032;the&#0032;Flights&#0032;table&#0032;and&#0032;with&#0032;a&#0032;where&#0032;clause&#0032;that&#0032;have&#0032;NotEquals&#0032;&#0060;&#0062;&#0032;to&#0032;the&#0032;callsigns&#0046;&#0032;Let’s&#0032;rename&#0032;some&#0032;columns&#0032;to&#0032;make&#0032;it&#0032;easier&#0032;to&#0032;read&#0046;&#0010;&#0010;let&#0032;s2&#0095;level&#0032;&#0061;&#0032;11&#0059;&#0032;&#0047;&#0047;&#0032;11&#0032;is&#0032;also&#0032;the&#0032;default&#0032;value&#0032;if&#0032;you&#0032;don&#0039;t&#0032;specify&#0032;it&#0010;let&#0032;SuspiciousFlights&#0032;&#0061;&#0010;Airports&#0010;&#0124;&#0032;where&#0032;municipality&#0032;has&#0032;&#0034;Doha&#0034;&#0010;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0124;&#0032;join&#0032;kind&#0061;inner&#0032;&#0040;&#0010;&#0032;&#0032;&#0032;&#0032;Flights&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;where&#0032;Timestamp&#0032;between&#0032;&#0040;datetime&#0040;2023&#0045;08&#0045;11&#0032;03&#0058;30&#0041;&#0032;&#0046;&#0046;&#0032;datetime&#0040;2023&#0045;08&#0045;11&#0032;05&#0058;30&#0041;&#0041;&#0032;and&#0032;onground&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0032;&#0032;&#0032;&#0032;&#0041;&#0032;on&#0032;key&#0010;&#0124;&#0032;distinct&#0032;callsign&#0059;&#0010;Flights&#0010;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0124;&#0032;where&#0032;callsign&#0032;in&#0032;&#0040;SuspiciousFlights&#0041;&#0032;and&#0032;onground&#0032;&#0061;&#0061;&#0032;false&#0032;and&#0032;Timestamp&#0032;&#0062;&#0032;datetime&#0040;2023&#0045;08&#0045;11&#0032;03&#0058;30&#0041;&#0010;&#0124;&#0032;join&#0032;kind&#0061;inner&#0032;&#0040;&#0010;&#0032;&#0032;&#0032;&#0032;Flights&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;extend&#0032;allFlights&#0032;&#0061;&#0032;callsign&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0041;&#0032;on&#0032;key&#0044;&#0032;Timestamp&#0010;&#0124;&#0032;where&#0032;callsign&#0032;&#0060;&#0062;&#0032;allFlights&#0010;&#0010;&#0010;1076&#0032;records&#0046;&#0032;I&#0032;do&#0032;hope&#0032;we&#0032;can&#0032;narrow&#0032;it&#0032;down&#0032;a&#0032;bit&#0032;more&#0046;&#0010;New&#0032;assumptions&#0010;Let’s&#0032;start&#0032;assuming&#0032;some&#0032;things&#0046;&#0032;This&#0032;is&#0032;where&#0032;I&#0032;was&#0032;stuck&#0032;for&#0032;some&#0032;time&#0046;&#0010;The&#0032;two&#0032;flights&#0032;are&#0032;going&#0032;the&#0032;same&#0032;direction&#0032;&#0040;Heading&#0032;column&#0044;&#0032;took&#0032;me&#0032;a&#0032;while&#0032;to&#0032;figure&#0032;that&#0032;out&#0041;&#0010;The&#0032;two&#0032;flights&#0032;have&#0032;the&#0032;same&#0032;speed&#0063;&#0032;&#0040;Velocity&#0032;column&#0044;&#0032;English&#0032;is&#0032;not&#0032;my&#0032;first&#0032;language&#0041;&#0010;The&#0032;two&#0032;flights&#0032;have&#0032;some&#0032;difference&#0032;in&#0032;altitude&#0010;I&#0032;was&#0032;trying&#0032;to&#0032;look&#0032;at&#0032;the&#0032;difference&#0032;at&#0032;both&#0032;longitude&#0032;and&#0032;latitude&#0032;but&#0032;when&#0032;I&#0032;did&#0032;understand&#0032;the&#0032;heading&#0032;column&#0032;it&#0032;was&#0032;much&#0032;easier&#0046;&#0010;Kusto&#0032;will&#0032;be&#0032;our&#0032;friend&#0032;in&#0032;math&#0032;here&#0046;&#0010;&#0010;&#0124;&#0032;extend&#0032;HeadingDiff&#0032;&#0061;&#0032;heading&#0032;&#0045;&#0032;heading1&#0010;&#0124;&#0032;extend&#0032;VelocityDiff&#0032;&#0061;&#0032;velocity&#0032;&#0045;&#0032;velocity1&#0010;&#0124;&#0032;extend&#0032;AltitudeDiff&#0032;&#0061;&#0032;geoaltitude&#0032;&#0045;&#0032;geoaltitude1&#0010;&#0010;&#0010;Looking&#0032;at&#0032;the&#0032;three&#0032;new&#0032;columns&#0032;we&#0032;have&#0032;a&#0032;mix&#0032;of&#0032;result&#0046;&#0032;Should&#0032;we&#0032;try&#0032;to&#0032;round&#0032;things&#0032;up&#0063;&#0032;I&#0032;don’t&#0032;know&#0044;&#0032;let’s&#0032;try&#0032;it&#0046;&#0010;&#0010;&#0124;&#0032;extend&#0032;HeadingDiff&#0032;&#0061;&#0032;round&#0040;heading&#0032;&#0045;&#0032;heading1&#0044;&#0032;0&#0041;&#0010;&#0124;&#0032;extend&#0032;VelocityDiff&#0032;&#0061;&#0032;round&#0040;velocity&#0032;&#0045;&#0032;velocity1&#0044;&#0032;0&#0041;&#0010;&#0124;&#0032;extend&#0032;AltitudeDiff&#0032;&#0061;&#0032;round&#0040;geoaltitude&#0032;&#0045;&#0032;geoaltitude1&#0044;&#0032;0&#0041;&#0010;&#0010;&#0010;I&#0032;think&#0032;it’s&#0032;better&#0032;output&#0032;now&#0046;&#0010;Assumption&#0032;1&#0010;To&#0032;answer&#0032;the&#0032;first&#0032;assumption&#0044;&#0032;we&#0032;need&#0032;to&#0032;find&#0032;the&#0032;flights&#0032;that&#0032;have&#0032;a&#0032;heading&#0032;difference&#0032;of&#0032;0&#0046;&#0032;We&#0032;will&#0032;use&#0032;the&#0032;where&#0032;clause&#0032;to&#0032;filter&#0032;out&#0032;the&#0032;result&#0046;&#0010;&#0010;&#0124;&#0032;where&#0032;HeadingDiff&#0032;&#0061;&#0061;&#0032;0&#0010;&#0010;&#0010;67&#0032;records&#0046;&#0032;Watch&#0032;out&#0032;Krypto&#0044;&#0032;we’re&#0032;coming&#0032;for&#0032;you&#0033;&#0010;Assumption&#0032;2&#0010;To&#0032;answer&#0032;the&#0032;second&#0032;assumption&#0044;&#0032;we&#0032;need&#0032;to&#0032;find&#0032;the&#0032;flights&#0032;that&#0032;have&#0032;a&#0032;very&#0032;close&#0032;velocity&#0032;difference&#0044;&#0032;maybe&#0032;a&#0032;value&#0032;of&#0032;&#0040;less&#0032;than&#0041;&#0032;10&#0063;&#0032;We&#0032;will&#0032;use&#0032;the&#0032;where&#0032;clause&#0032;to&#0032;filter&#0032;out&#0032;the&#0032;result&#0046;&#0010;&#0010;&#0124;&#0032;where&#0032;HeadingDiff&#0032;&#0061;&#0061;&#0032;0&#0032;and&#0032;VelocityDiff&#0032;&#0060;&#0032;10&#0010;&#0010;&#0010;50&#0032;records&#0046;&#0032;Getting&#0032;closer&#0046;&#0032;Krypto&#0032;you&#0032;can&#0032;run&#0044;&#0032;but&#0032;you&#0032;can’t&#0032;hide&#0033;&#0010;Assumption&#0032;3&#0010;To&#0032;answer&#0032;the&#0032;third&#0032;assumption&#0044;&#0032;we&#0032;need&#0032;to&#0032;find&#0032;the&#0032;flights&#0032;that&#0032;have&#0032;a&#0032;very&#0032;close&#0032;altitude&#0032;difference&#0044;&#0032;maybe&#0032;a&#0032;value&#0032;of&#0032;&#0040;less&#0032;than&#0041;&#0032;2000&#0032;but&#0032;more&#0032;than&#0032;100&#0063;&#0032;We&#0032;will&#0032;use&#0032;the&#0032;where&#0032;clause&#0032;and&#0032;between&#0040;&#0041;&#0032;operator&#0032;to&#0032;filter&#0032;out&#0032;the&#0032;result&#0046;&#0010;&#0010;&#0124;&#0032;where&#0032;HeadingDiff&#0032;&#0061;&#0061;&#0032;0&#0032;and&#0032;VelocityDiff&#0032;&#0060;&#0032;10&#0032;and&#0032;AltitudeDiff&#0032;between&#0032;&#0040;100&#0032;&#0046;&#0046;&#0032;2000&#0041;&#0010;&#0010;&#0010;Closing&#0032;in&#0032;on&#0032;Krypto&#0010;The&#0032;entire&#0032;query&#0032;right&#0032;now&#0058;&#0010;&#0010;let&#0032;s2&#0095;level&#0032;&#0061;&#0032;11&#0059;&#0032;&#0047;&#0047;&#0032;11&#0032;is&#0032;also&#0032;the&#0032;default&#0032;value&#0032;if&#0032;you&#0032;don&#0039;t&#0032;specify&#0032;it&#0010;let&#0032;SuspiciousFlights&#0032;&#0061;&#0010;Airports&#0010;&#0124;&#0032;where&#0032;municipality&#0032;has&#0032;&#0034;Doha&#0034;&#0010;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0124;&#0032;join&#0032;kind&#0061;inner&#0032;&#0040;&#0010;&#0032;&#0032;&#0032;&#0032;Flights&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;where&#0032;Timestamp&#0032;between&#0032;&#0040;datetime&#0040;2023&#0045;08&#0045;11&#0032;03&#0058;30&#0041;&#0032;&#0046;&#0046;&#0032;datetime&#0040;2023&#0045;08&#0045;11&#0032;05&#0058;30&#0041;&#0041;&#0032;and&#0032;onground&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0032;&#0032;&#0032;&#0032;&#0041;&#0032;on&#0032;key&#0010;&#0124;&#0032;distinct&#0032;callsign&#0059;&#0010;Flights&#0010;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0124;&#0032;where&#0032;callsign&#0032;in&#0032;&#0040;SuspiciousFlights&#0041;&#0032;and&#0032;onground&#0032;&#0061;&#0061;&#0032;false&#0032;and&#0032;Timestamp&#0032;&#0062;&#0032;datetime&#0040;2023&#0045;08&#0045;11&#0032;03&#0058;30&#0041;&#0010;&#0124;&#0032;join&#0032;kind&#0061;inner&#0032;&#0040;&#0010;&#0032;&#0032;&#0032;&#0032;Flights&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;extend&#0032;allFlights&#0032;&#0061;&#0032;callsign&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0041;&#0032;on&#0032;key&#0044;&#0032;Timestamp&#0010;&#0124;&#0032;where&#0032;callsign&#0032;&#0060;&#0062;&#0032;allFlights&#0010;&#0124;&#0032;extend&#0032;HeadingDiff&#0032;&#0061;&#0032;round&#0040;heading&#0032;&#0045;&#0032;heading1&#0044;&#0032;0&#0041;&#0010;&#0124;&#0032;extend&#0032;VelocityDiff&#0032;&#0061;&#0032;round&#0040;velocity&#0032;&#0045;&#0032;velocity1&#0044;&#0032;0&#0041;&#0010;&#0124;&#0032;extend&#0032;AltitudeDiff&#0032;&#0061;&#0032;round&#0040;geoaltitude&#0032;&#0045;&#0032;geoaltitude1&#0044;&#0032;0&#0041;&#0010;&#0124;&#0032;where&#0032;HeadingDiff&#0032;&#0061;&#0061;&#0032;0&#0032;and&#0032;VelocityDiff&#0032;&#0060;&#0032;10&#0032;and&#0032;AltitudeDiff&#0032;between&#0032;&#0040;100&#0032;&#0046;&#0046;&#0032;2000&#0041;&#0010;&#0010;&#0010;7&#0032;records&#0046;&#0032;I&#0032;think&#0032;we&#0032;got&#0032;it&#0033;&#0032;Now&#0032;we&#0032;need&#0032;to&#0032;find&#0032;out&#0032;where&#0032;this&#0032;flight&#0032;is&#0032;going&#0046;&#0032;We&#0032;will&#0032;make&#0032;a&#0032;new&#0032;join&#0032;with&#0032;the&#0032;Flights&#0032;table&#0032;to&#0032;get&#0032;the&#0032;last&#0032;record&#0032;of&#0032;that&#0032;flight&#0032;with&#0032;the&#0032;geo&#0032;data&#0032;then&#0032;use&#0032;the&#0032;lookup&#0032;operator&#0032;to&#0032;find&#0032;the&#0032;airport&#0046;&#0010;&#0010;let&#0032;s2&#0095;level&#0032;&#0061;&#0032;11&#0059;&#0032;&#0047;&#0047;&#0032;11&#0032;is&#0032;also&#0032;the&#0032;default&#0032;value&#0032;if&#0032;you&#0032;don&#0039;t&#0032;specify&#0032;it&#0010;let&#0032;SuspiciousFlights&#0032;&#0061;&#0010;Airports&#0010;&#0124;&#0032;where&#0032;municipality&#0032;has&#0032;&#0034;Doha&#0034;&#0010;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0124;&#0032;join&#0032;kind&#0061;inner&#0032;&#0040;&#0010;&#0032;&#0032;&#0032;&#0032;Flights&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;where&#0032;Timestamp&#0032;between&#0032;&#0040;datetime&#0040;2023&#0045;08&#0045;11&#0032;03&#0058;30&#0041;&#0032;&#0046;&#0046;&#0032;datetime&#0040;2023&#0045;08&#0045;11&#0032;05&#0058;30&#0041;&#0041;&#0032;and&#0032;onground&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0032;&#0032;&#0032;&#0032;&#0041;&#0032;on&#0032;key&#0010;&#0124;&#0032;distinct&#0032;callsign&#0059;&#0010;Flights&#0010;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0124;&#0032;where&#0032;callsign&#0032;in&#0032;&#0040;SuspiciousFlights&#0041;&#0032;and&#0032;onground&#0032;&#0061;&#0061;&#0032;false&#0032;and&#0032;Timestamp&#0032;&#0062;&#0032;datetime&#0040;2023&#0045;08&#0045;11&#0032;03&#0058;30&#0041;&#0010;&#0124;&#0032;join&#0032;kind&#0061;inner&#0032;&#0040;&#0010;&#0032;&#0032;&#0032;&#0032;Flights&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;extend&#0032;allFlights&#0032;&#0061;&#0032;callsign&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0041;&#0032;on&#0032;key&#0044;&#0032;Timestamp&#0010;&#0124;&#0032;where&#0032;callsign&#0032;&#0060;&#0062;&#0032;allFlights&#0010;&#0124;&#0032;extend&#0032;HeadingDiff&#0032;&#0061;&#0032;round&#0040;heading&#0032;&#0045;&#0032;heading1&#0044;&#0032;0&#0041;&#0010;&#0124;&#0032;extend&#0032;VelocityDiff&#0032;&#0061;&#0032;round&#0040;velocity&#0032;&#0045;&#0032;velocity1&#0044;&#0032;0&#0041;&#0010;&#0124;&#0032;extend&#0032;AltitudeDiff&#0032;&#0061;&#0032;round&#0040;geoaltitude&#0032;&#0045;&#0032;geoaltitude1&#0044;&#0032;0&#0041;&#0010;&#0124;&#0032;where&#0032;HeadingDiff&#0032;&#0061;&#0061;&#0032;0&#0032;and&#0032;VelocityDiff&#0032;&#0060;&#0032;10&#0032;and&#0032;AltitudeDiff&#0032;between&#0032;&#0040;100&#0032;&#0046;&#0046;&#0032;2000&#0041;&#0010;&#0124;&#0032;project&#0032;callsign&#0032;&#0061;&#0032;callsign1&#0010;&#0124;&#0032;join&#0032;kind&#0061;inner&#0032;&#0040;&#0010;&#0032;&#0032;&#0032;&#0032;Flights&#0010;&#0032;&#0032;&#0032;&#0032;&#0041;&#0032;on&#0032;callsign&#0010;&#0124;&#0032;top&#0032;1&#0032;by&#0032;Timestamp&#0032;desc&#0010;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0124;&#0032;lookup&#0032;&#0040;&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;Airports&#0032;&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0041;&#0032;on&#0032;key&#0010;&#0010;&#0010;Hey&#0032;NSO&#0044;&#0032;send&#0032;all&#0032;units&#0032;to&#0032;the&#0032;Josep&#0032;Tarradellas&#0032;Barcelona&#0045;El&#0032;Prat&#0032;Airport&#0032;in&#0032;Barcelona&#0044;&#0032;Spain&#0046;&#0032;We&#0032;got&#0032;him&#0033;&#0010;The&#0032;jump&#0010;Now&#0032;I’m&#0032;super&#0032;curious&#0032;about&#0032;the&#0032;jump&#0044;&#0032;where&#0032;it&#0032;took&#0032;place&#0044;&#0032;when&#0032;and&#0032;how&#0046;&#0010;&#0010;Flights&#0010;&#0124;&#0032;where&#0032;callsign&#0032;in&#0032;&#0040;&#0034;OJIT393&#0034;&#0044;&#0032;&#0034;HFID97&#0034;&#0041;&#0010;&#0124;&#0032;sort&#0032;by&#0032;callsign&#0044;&#0032;Timestamp&#0032;asc&#0010;&#0124;&#0032;extend&#0032;Map&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;14&#0041;&#0010;&#0124;&#0032;project&#0032;geo&#0095;s2cell&#0095;to&#0095;central&#0095;point&#0040;Map&#0041;&#0044;&#0032;callsign&#0010;&#0124;&#0032;render&#0032;scatterchart&#0032;with&#0032;&#0040;kind&#0061;map&#0041;&#0010;&#0010;&#0010;&#0010;&#0010;And&#0032;the&#0032;time&#0063;&#0010;&#0010;let&#0032;s2&#0095;level&#0032;&#0061;&#0032;11&#0059;&#0032;&#0047;&#0047;&#0032;11&#0032;is&#0032;also&#0032;the&#0032;default&#0032;value&#0032;if&#0032;you&#0032;don&#0039;t&#0032;specify&#0032;it&#0010;let&#0032;SuspiciousFlights&#0032;&#0061;&#0010;Airports&#0010;&#0124;&#0032;where&#0032;municipality&#0032;has&#0032;&#0034;Doha&#0034;&#0010;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0124;&#0032;join&#0032;kind&#0061;inner&#0032;&#0040;&#0010;&#0032;&#0032;&#0032;&#0032;Flights&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;where&#0032;Timestamp&#0032;between&#0032;&#0040;datetime&#0040;2023&#0045;08&#0045;11&#0032;03&#0058;30&#0041;&#0032;&#0046;&#0046;&#0032;datetime&#0040;2023&#0045;08&#0045;11&#0032;05&#0058;30&#0041;&#0041;&#0032;and&#0032;onground&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0032;&#0032;&#0032;&#0032;&#0041;&#0032;on&#0032;key&#0010;&#0124;&#0032;distinct&#0032;callsign&#0059;&#0010;Flights&#0010;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0124;&#0032;where&#0032;callsign&#0032;in&#0032;&#0040;SuspiciousFlights&#0041;&#0032;and&#0032;onground&#0032;&#0061;&#0061;&#0032;false&#0032;and&#0032;Timestamp&#0032;&#0062;&#0032;datetime&#0040;2023&#0045;08&#0045;11&#0032;03&#0058;30&#0041;&#0010;&#0124;&#0032;join&#0032;kind&#0061;inner&#0032;&#0040;&#0010;&#0032;&#0032;&#0032;&#0032;Flights&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;extend&#0032;key&#0061;geo&#0095;point&#0095;to&#0095;s2cell&#0040;lon&#0044;&#0032;lat&#0044;&#0032;s2&#0095;level&#0041;&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0124;&#0032;extend&#0032;allFlights&#0032;&#0061;&#0032;callsign&#0010;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0032;&#0041;&#0032;on&#0032;key&#0044;&#0032;Timestamp&#0010;&#0124;&#0032;where&#0032;callsign&#0032;&#0060;&#0062;&#0032;allFlights&#0010;&#0124;&#0032;extend&#0032;HeadingDiff&#0032;&#0061;&#0032;round&#0040;heading&#0032;&#0045;&#0032;heading1&#0044;&#0032;0&#0041;&#0010;&#0124;&#0032;extend&#0032;VelocityDiff&#0032;&#0061;&#0032;round&#0040;velocity&#0032;&#0045;&#0032;velocity1&#0044;&#0032;0&#0041;&#0010;&#0124;&#0032;extend&#0032;AltitudeDiff&#0032;&#0061;&#0032;round&#0040;geoaltitude&#0032;&#0045;&#0032;geoaltitude1&#0044;&#0032;0&#0041;&#0010;&#0124;&#0032;where&#0032;HeadingDiff&#0032;&#0061;&#0061;&#0032;0&#0032;and&#0032;VelocityDiff&#0032;&#0060;&#0032;10&#0032;and&#0032;AltitudeDiff&#0032;between&#0032;&#0040;100&#0032;&#0046;&#0046;&#0032;2000&#0041;&#0010;&#0010;&#0010;Between&#0032;11&#0058;44&#0058;00&#0032;&#0045;&#0032;11&#0058;47&#0058;30&#0046;&#0032;As&#0032;you&#0032;can&#0032;see&#0032;on&#0032;the&#0032;map&#0044;&#0032;the&#0032;airplan&#0032;took&#0032;a&#0032;very&#0032;hard&#0032;turn&#0032;to&#0032;the&#0032;left&#0032;after&#0032;the&#0032;jump…&#0010;And&#0032;the&#0032;how&#0063;&#0010;I&#0032;have&#0032;no&#0032;clue…&#0032;Crazy&#0032;man&#0046;</div>
          <div class="date">8&#0047;15&#0047;23</div>
          <div class="data">
            <span class="author"></span> 
          </div>
        </div>
      </div>
    </foreignObject>
  </g>
</svg>